<!DOCTYPE html>
<html>
<head>
    <title>Interactive Basis Vectors with p5.js</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
    </style>
</head>
<body>
    <script>
        let v, basis1, basis2;
        let draggingV = false, draggingBasis1 = false, draggingBasis2 = false;
        const handleRadius = 5;

        function setup() {
            createCanvas(400, 400);
            angleMode(DEGREES);
            v = createVector(100, 50);
            basis1 = createVector(50, 0);
            basis2 = createVector(0, 50);
        }

        function draw() {
            background(255);
            translate(width / 2, height / 2);
            drawGrid();
            drawAxes();

            // Update vectors if dragging
            if (draggingV) {
                v.x = mouseX - width / 2;
                v.y = mouseY - height / 2;
            } else if (draggingBasis1) {
                basis1.x = mouseX - width / 2;
                basis1.y = mouseY - height / 2;
                basis2 = createVector(-basis1.y, basis1.x); // 90 degrees rotated
            } else if (draggingBasis2) {
                basis2.x = mouseX - width / 2;
                basis2.y = mouseY - height / 2;
                basis1 = createVector(basis2.y, -basis2.x); // 90 degrees rotated
            }

            // Draw vectors
            drawVector(v, 'blue');
            drawVector(basis1, 'green');
            drawVector(basis2, 'green');

            // Draw projections with thick black lines
            strokeWeight(4);
            stroke(0);
            drawProjection(v, basis1);
            drawProjection(v, basis2);
            strokeWeight(1);

            // Draw handles
            fill(255);
            ellipse(v.x, v.y, handleRadius * 2);
            ellipse(basis1.x, basis1.y, handleRadius * 2);
            ellipse(basis2.x, basis2.y, handleRadius * 2);

            // Display coordinates
            displayCoordinates(v, basis1, basis2);
        }

        function mousePressed() {
            if (dist(mouseX, mouseY, v.x + width / 2, v.y + height / 2) < handleRadius) {
                draggingV = true;
            } else if (dist(mouseX, mouseY, basis1.x + width / 2, basis1.y + height / 2) < handleRadius) {
                draggingBasis1 = true;
            } else if (dist(mouseX, mouseY, basis2.x + width / 2, basis2.y + height / 2) < handleRadius) {
                draggingBasis2 = true;
            }
        }

        function mouseReleased() {
            draggingV = draggingBasis1 = draggingBasis2 = false;
        }

        function drawVector(vec, color) {
            stroke(color);
            line(0, 0, vec.x, vec.y);
            ellipse(vec.x, vec.y, 5, 5);
        }

        function drawProjection(vec, basis) {
            let proj = project(vec, basis);
            line(0, 0, proj.x, proj.y);
        }

        function project(vec, basis) {
            let scalar = vec.dot(basis) / basis.magSq();
            return p5.Vector.mult(basis, scalar);
        }

        function drawGrid() {
            stroke(200);
            for (let x = -width; x < width; x += 20) {
                line(x, -height, x, height);
            }
            for (let y = -height; y < height; y += 20) {
                line(-width, y, width, y);
            }
        }

        function drawAxes() {
            strokeWeight(3);
            stroke(0);
            line(-width / 2, 0, width / 2, 0); // X-axis
            line(0, -height / 2, 0, height / 2); // Y-axis
            strokeWeight(1);
        }

        function displayCoordinates(vec, basis1, basis2) {
            let coordsStandard = `Standard: (${vec.x.toFixed(2)}, ${vec.y.toFixed(2)})`;
            let coordsBasis = `Basis: (${project(vec, basis1).mag().toFixed(2)}, ${project(vec, basis2).mag().toFixed(2)})`;
            fill(0);
            text(coordsStandard, 10 - width / 2, 20 - height / 2);
            text(coordsBasis, 10 - width / 2, 40 - height / 2);
        }
    </script>
</body>
</html>
